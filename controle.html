<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle Mensal de Gastos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            color: #4CAF50;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
        .display-box, .input-box, button {
            font-size: 1.2em;
            color: #333;
            margin: 10px 0;
            padding: 10px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            border: 1px solid #ccc;
        }
        .input-box {
            background-color: white; /* Fundo branco para entrada manual */
        }
        #baseMonthlyDisplay, #benefitsDisplay {
            background-color: #e1f5fe; /* Azul muito claro para valores exibidos */
        }
        #availableFundsBase, #availableFundsBenefits {
            background-color: #e1f5fe; /* Azul muito claro para valores exibidos */
        }
        #benefitsExpenseInput {
            background-color: #ffe0b2; /* Laranja claro para gasto benefício */
        }
        #savingsGoalInput, #savingsTimeDisplay {
            background-color: #e0e0e0; /* Cinza claro para valor a acumular e tempo estimado */
        }
        #revenueInput {
            background-color: #c8e6c9; /* verde claro ganho */
        }
        #expenseInput {
            background-color: #ffcdd2; /* vermelho claro gasto */
        }
        .button-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        .expense-btn { background-color: #f44336; }
        .reset-btn { background-color: #2196F3; }
        .expense-btn[onclick="subtractBenefitExpense()"] {
          background-color: orange;
        }
        .negative {
          color: red;
        }
    </style>
</head>
<body>
    <h1>Controle Mensal de Gastos</h1>
    
    <div class="container">
        <input type="number" id="baseMonthlyInput" class="input-box" placeholder="Valor Base Mensal" oninput="setBaseMonthlyValue()">
        <input type="number" id="benefitsInput" class="input-box" placeholder="Outros Benefícios" oninput="setBaseMonthlyValue()">
        
        <div id="baseMonthlyDisplay" class="display-box"></div>
        <div id="benefitsDisplay" class="display-box"></div>
        <div id="availableFundsBase" class="display-box"></div>
        <div id="availableFundsBenefits" class="display-box"></div>

        <input type="number" id="expenseInput" class="input-box" placeholder="Valor do Gasto">
        <button class="expense-btn" onclick="addTransaction('expense')">Adicionar Gasto</button>

        <input type="number" id="revenueInput" class="input-box" placeholder="Valor do Ganho">
        <button class="revenue-btn" onclick="addTransaction('revenue')">Adicionar Ganho</button>

        <input type="number" id="benefitsExpenseInput" class="input-box" placeholder="Gasto com Benefícios">
        <button class="expense-btn" onclick="subtractBenefitExpense()">Adicionar Desconto Benefício</button>
        
        <input type="number" id="savingsGoalInput" class="input-box" placeholder="Valor que deseja acumular" oninput="calculateTimeToSave()">
        <div id="savingsTimeDisplay" class="display-box"></div>
        
        <div class="button-container">
            <button class="reset-btn" onclick="resetMonth()">Resetar (iniciar novo mês)</button>
        </div>
    </div>
    
    <script>
        let baseMonthlyValue = parseFloat(localStorage.getItem("baseMonthlyValue")) || 3500;
        let benefitsValue = parseFloat(localStorage.getItem("benefitsValue")) || 1000;
        let accumulatedBase = parseFloat(localStorage.getItem("accumulatedBase")) || 0;
        let accumulatedBenefits = parseFloat(localStorage.getItem("accumulatedBenefits")) || 0;

        function saveData() {
            localStorage.setItem("baseMonthlyValue", baseMonthlyValue);
            localStorage.setItem("benefitsValue", benefitsValue);
            localStorage.setItem("accumulatedBase", accumulatedBase);
            localStorage.setItem("accumulatedBenefits", accumulatedBenefits);
        }

        function getIncrementPerMinute(value) {
            return value / (30 * 24 * 60);
        }

        function setBaseMonthlyValue() {
            baseMonthlyValue = parseFloat(document.getElementById("baseMonthlyInput").value) || 0;
            benefitsValue = parseFloat(document.getElementById("benefitsInput").value) || 1000;
            accumulatedBase = 0;
            accumulatedBenefits = 0;
            saveData();
            updateDisplay();
        }

        function subtractBenefitExpense() {
            let expense = parseFloat(document.getElementById("benefitsExpenseInput").value) || 0;
            if (expense > accumulatedBenefits) {
                alert("Saldo insuficiente nos benefícios.");
                return;
            }
            accumulatedBenefits -= expense;
            saveData();
            updateDisplay();
        }

        function addTransaction(type) {
            let inputId = (type === 'revenue') ? "revenueInput" : "expenseInput";
            let input = document.getElementById(inputId);
            let value = parseFloat(input.value) || 0;
            
            if (value === 0) {
                alert("Por favor, insira um valor válido.");
                return;
            }
            
            if (type === 'expense') {
                accumulatedBase -= value;
                baseMonthlyValue -= value;
            } else {
                accumulatedBase += value;
                baseMonthlyValue += value;
            }
            saveData();
            updateDisplay();
            input.value = "";
        }

        function accumulateAutoGain() {
            let baseGain = getIncrementPerMinute(baseMonthlyValue);
            let benefitsGain = getIncrementPerMinute(benefitsValue);
            accumulatedBase += baseGain;
            accumulatedBenefits += benefitsGain;
            baseMonthlyValue -= baseGain;
            benefitsValue -= benefitsGain;
            saveData();
            updateDisplay();
        }

        function calculateTimeToSave() {
            let goal = parseFloat(document.getElementById("savingsGoalInput").value) || 0;
            let gainPerMinute = getIncrementPerMinute(baseMonthlyValue);
            let timeRequired = goal / gainPerMinute;
            let hours = Math.floor(timeRequired / 60);
            let minutes = Math.floor(timeRequired % 60);
            document.getElementById("savingsTimeDisplay").innerText = `Tempo estimado para acumular: ${hours}h ${minutes}m`;
        }

        function resetMonth() {
            baseMonthlyValue = 3500;
            benefitsValue = 1000;
            accumulatedBase = 0;
            accumulatedBenefits = 0;
            saveData();
            updateDisplay();
        }

        function updateDisplay() {
            document.getElementById("baseMonthlyDisplay").innerText = `Valor Base Mensal: R$ ${baseMonthlyValue.toFixed(2)}`;
            document.getElementById("benefitsDisplay").innerText = `Benefícios: R$ ${benefitsValue.toFixed(2)}`;
            document.getElementById("availableFundsBase").innerText = `Disponível da Base Mensal: R$ ${accumulatedBase.toFixed(2)}`;
            document.getElementById("availableFundsBenefits").innerText = `Disponível dos Benefícios: R$ ${accumulatedBenefits.toFixed(2)}`;

            if (accumulatedBase < 0) {
              document.getElementById("availableFundsBase").classList.add('negative');
            } else {
              document.getElementById("availableFundsBase").classList.remove('negative');
            }
        }

        window.onload = function() {
            updateDisplay();
            setInterval(accumulateAutoGain, 60000);
        };
    </script>
</body>
</html>
